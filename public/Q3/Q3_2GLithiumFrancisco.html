<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Noah Connor C. Francisco">
    <title>Club Application Form</title>
    <link rel="icon" type="image/jpg" href="../public/assets/430-4305671_pshs-logo-philippine-science-high-school-logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css.css">
</head>
<body>

<h1>Club Application</h1>
<h2>Join the Different Organizations!</h2>

<form id="clubForm">
    <fieldset>
        <legend>Student Information</legend>
        <label>Student ID: <input type="number" id="studentID" required onblur="checkEmpty(this)"></label>
        <label>Full Name: <input type="text" id="fullName" required onblur="checkEmpty(this)"></label>
        <label>Birthday: <input type="date" id="birthday" required></label>
        <label>Email Address: <input type="email" id="email" required onblur="checkEmpty(this)"></label>
    </fieldset>

    <fieldset>
        <legend>Membership Details</legend>
        <label>Phone Number: <input type="text" id="mobile" required onblur="checkEmpty(this)"></label>
        <label>Grade:
            <select id="grade" required>
                <option value="">-- Select Grade --</option>
                <option value="Grade 7">Grade 7</option>
                <option value="Grade 8">Grade 8</option>
                <option value="Grade 9">Grade 9</option>
                <option value="Grade 10">Grade 10</option>
                <option value="Grade 11">Grade 11</option>
                <option value="Grade 12">Grade 12</option>
            </select>
        </label>

        <label>Intern / Extern:</label>
        <div class="radio-group">
            <label><input type="radio" name="status" value="Intern" required> Intern</label>
            <label><input type="radio" name="status" value="Extern" required> Extern</label>
        </div>

        <label>Preferred Club:
            <select id="clubChoice" required>
                <option value="">-- Choose a Club --</option>
                <option value="Volant">Volant</option>
                <option value="Invictus">Invictus</option>
                <option value="MUN">MUN</option>
                <option value="AstroSoc">AstroSoc</option>
                <option value="AKSIS">AKSIS</option>
                <option value="Pallastro">Pallastro</option>
            </select>
        </label>

        <label>Why do you want to join? <textarea id="motivation" required onblur="checkEmpty(this)"></textarea></label>
    </fieldset>

    <div class="buttons">
        <button type="submit">Submit Application</button>
        <button type="reset" onclick="return confirmReset()">Reset Form</button>
        <button type="button" class="view-btn" onclick="window.location.href='viewSignUps.html'">View Signups</button>
    </div>
</form>

<script>
    const KEY = 'clubSignups';

    function loadSignups() {
        const raw = localStorage.getItem(KEY);
        if (raw) return JSON.parse(raw);
        return [];
    }

    function saveSignups(entries) {
        localStorage.setItem(KEY, JSON.stringify(entries));
    }

    function checkEmpty(element) {
        if (element.value.trim() === "") {
            element.classList.add("invalid");
        } else {
            element.classList.remove("invalid");
        }
    }

    function confirmReset() {
        return confirm("Do you really want to reset all the form information?");
    }

    const clubForm = document.getElementById('clubForm');
    clubForm.onsubmit = function(event) {
        event.preventDefault();
        if (!confirm("Are you sure you want to submit your club application?")) return;

        const obj = {
            id: document.getElementById('studentID').value.trim(),
            fullname: document.getElementById('fullName').value.trim(),
            birthday: document.getElementById('birthday').value,
            email: document.getElementById('email').value.trim(),
            mobile: document.getElementById('mobile').value.trim(),
            grade: document.getElementById('grade').value,
            status: document.querySelector('input[name="status"]:checked').value,
            club: document.getElementById('clubChoice').value,
            time: new Date().toLocaleTimeString()
        };

        const signups = loadSignups();
        signups.push(obj);
        saveSignups(signups);
        
        alert("Application Saved Successfully.");
        clubForm.reset();
    };
</script>
</body>
</html>